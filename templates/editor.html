<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂèØËßÜÂåñÂ§ßÂ±èÁºñËæëÂô®</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- ÁªÑ‰ª∂Â∫ìÈù¢Êùø -->
        <aside class="component-panel">
            <div class="component-panel-header">
                <h2>üìö ÁªÑ‰ª∂Â∫ì</h2>
            </div>
            <div class="component-library" id="component-library">
                <!-- ÁªÑ‰ª∂Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÂä†ËΩΩ -->
            </div>
        </aside>
        
        <!-- ‰∏ªÁºñËæëÂå∫Âüü -->
        <main class="editor-main">
            <!-- Â∑•ÂÖ∑Ê†è -->
            <div class="toolbar" id="toolbar">
                <div class="toolbar-group">
                    <button class="toolbar-button primary" id="save-btn">
                        üíæ ‰øùÂ≠ò
                    </button>
                    <button class="toolbar-button" id="preview-btn">
                        üëÅÔ∏è È¢ÑËßà
                    </button>
                </div>
                
                <div class="toolbar-group">
                    <button class="toolbar-button" id="export-btn">
                        üì§ ÂØºÂá∫
                    </button>
                    <button class="toolbar-button danger" id="clear-btn">
                        üóëÔ∏è Ê∏ÖÈô§
                    </button>
                </div>
                
                <!-- ‰∏ªÈ¢òÂàáÊç¢Âô® -->
                <div class="toolbar-group theme-switcher">
                    <label for="theme-selector" class="theme-label">üé® ‰∏ªÈ¢ò:</label>
                    <select id="theme-selector" class="theme-select">
                        <option value="default">ÈªòËÆ§‰∏ªÈ¢ò</option>
                        <option value="dark">Ê∑±Ëâ≤‰∏ªÈ¢ò</option>
                        <option value="vintage">Â§çÂè§‰∏ªÈ¢ò</option>
                        <option value="macarons">È©¨Âç°Èæô‰∏ªÈ¢ò</option>
                    </select>
                </div>
                
                <div class="toolbar-group" style="margin-left: auto;">
                    <a href="/" class="toolbar-button">
                        üìã ÁÆ°ÁêÜÈ°µÈù¢
                    </a>
                    <a href="/api-docs" class="toolbar-button">
                        üìö APIÊñáÊ°£
                    </a>
                </div>
            </div>
            
            <!-- ÁîªÂ∏ÉÂå∫Âüü -->
            <div class="canvas-area">
                <div class="canvas" id="canvas">
                    <!-- ÁªÑ‰ª∂Â∞ÜÊãñÊãΩÂà∞ËøôÈáå -->
                </div>
            </div>
            
            <!-- Áä∂ÊÄÅÊ†è -->
            <div class="status-bar" id="status-bar">
                <div class="status-item">
                    <span>ÁîªÂ∏É:</span>
                    <span id="canvas-size">1920 √ó 1080</span>
                </div>
                <div class="status-item">
                    <span id="component-count">ÁªÑ‰ª∂: 0</span>
                </div>
                <div class="status-item">
                    <span>Áä∂ÊÄÅ:</span>
                    <span id="save-status" class="status-clean">Â∑≤‰øùÂ≠ò</span>
                </div>
                <div class="status-item" style="margin-left: auto;">
                    <span>üé® ÂèØËßÜÂåñÂ§ßÂ±èÁºñËæëÂô®</span>
                </div>
            </div>
        </main>
        
        <!-- ÈÖçÁΩÆÈù¢Êùø -->
        <aside class="config-panel">
            <div class="config-panel-header">
                <h2>üéõÔ∏è ÈÖçÁΩÆÈù¢Êùø</h2>
            </div>
            <div class="config-panel-content" id="config-panel">
                <!-- ÈÖçÁΩÆÂÜÖÂÆπÂ∞ÜÊòæÁ§∫Âú®ËøôÈáå -->
            </div>
        </aside>
    </div>

    <!-- ÂºïÂÖ•‰æùËµñ -->
    <script src="/static/js/echarts.js"></script>
    <script src="/static/js/echarts-gl-master/dist/echarts-gl.min.js"></script>
    
    <!-- ECharts‰∏ªÈ¢ò -->
    <script>
        // Á≠âÂæÖEChartsÂä†ËΩΩÂÆåÊàêÂêéÊ≥®ÂÜå‰∏ªÈ¢ò
        function registerEChartsThemes() {
            if (window.echarts) {
            // Ê∑±Ëâ≤‰∏ªÈ¢ò
            echarts.registerTheme('dark', {
                color: ['#4FC3F7', '#81C784', '#FFB74D', '#F06292', '#64B5F6'],
                backgroundColor: '#1e1e1e',
                textStyle: {
                    color: '#ffffff'
                },
                title: {
                    textStyle: {
                        color: '#ffffff'
                    },
                    subtextStyle: {
                        color: '#cccccc'
                    }
                },
                legend: {
                    textStyle: {
                        color: '#ffffff'
                    }
                },
                tooltip: {
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    textStyle: {
                        color: '#ffffff'
                    }
                },
                categoryAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#333333'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                valueAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#333333'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                line: {
                    itemStyle: {
                        borderWidth: 1
                    },
                    lineStyle: {
                        width: 2
                    },
                    symbolSize: 4,
                    symbol: 'emptyCircle',
                    smooth: false
                },
                bar: {
                    itemStyle: {
                        barBorderWidth: 0,
                        barBorderColor: '#ccc'
                    }
                },
                pie: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                scatter: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                boxplot: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                parallel: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                sankey: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                funnel: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                gauge: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                candlestick: {
                    itemStyle: {
                        color: '#4FC3F7',
                        color0: '#F06292',
                        borderColor: '#4FC3F7',
                        borderColor0: '#F06292',
                        borderWidth: 1
                    }
                },
                graph: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    },
                    lineStyle: {
                        width: 1,
                        color: '#666666'
                    },
                    symbolSize: 4,
                    symbol: 'emptyCircle',
                    smooth: false,
                    label: {
                        show: false
                    },
                    labelLayout: {
                        hideOverlap: false
                    },
                    emphasis: {
                        focus: 'series',
                        blurScope: 'coordinateSystem'
                    }
                },
                map: {
                    itemStyle: {
                        areaColor: '#eee',
                        borderColor: '#444',
                        borderWidth: 0.5
                    },
                    label: {
                        color: '#000'
                    },
                    emphasis: {
                        itemStyle: {
                            areaColor: 'rgba(255,215,0,0.8)',
                            borderColor: '#444',
                            borderWidth: 1
                        },
                        label: {
                            color: 'rgb(100,0,0)'
                        }
                    }
                },
                geo: {
                    itemStyle: {
                        areaColor: '#eee',
                        borderColor: '#444',
                        borderWidth: 0.5
                    },
                    label: {
                        color: '#000'
                    },
                    emphasis: {
                        itemStyle: {
                            areaColor: 'rgba(255,215,0,0.8)',
                            borderColor: '#444',
                            borderWidth: 1
                        },
                        label: {
                            color: 'rgb(100,0,0)'
                        }
                    }
                },
                categoryAxis: {
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        show: false,
                        lineStyle: {
                            color: ['#333333']
                        }
                    },
                    splitArea: {
                        show: false,
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                valueAxis: {
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#333333']
                        }
                    },
                    splitArea: {
                        show: false,
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                logAxis: {
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#333333']
                        }
                    },
                    splitArea: {
                        show: false,
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                timeAxis: {
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#333333']
                        }
                    },
                    splitArea: {
                        show: false,
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                toolbox: {
                    iconStyle: {
                        borderColor: '#ffffff'
                    },
                    emphasis: {
                        iconStyle: {
                            borderColor: '#4FC3F7'
                        }
                    }
                },
                timeline: {
                    lineStyle: {
                        color: '#666666',
                        width: 1
                    },
                    itemStyle: {
                        color: '#666666',
                        borderWidth: 1
                    },
                    controlStyle: {
                        color: '#666666',
                        borderColor: '#666666',
                        borderWidth: 0.5
                    },
                    checkpointStyle: {
                        color: '#4FC3F7',
                        borderColor: '#ffffff'
                    },
                    label: {
                        color: '#ffffff'
                    },
                    emphasis: {
                        itemStyle: {
                            color: '#4FC3F7'
                        },
                        controlStyle: {
                            color: '#4FC3F7',
                            borderColor: '#4FC3F7',
                            borderWidth: 0.5
                        },
                        label: {
                            color: '#ffffff'
                        }
                    }
                },
                visualMap: {
                    color: ['#bf444c', '#d88273', '#f6efa6']
                },
                dataZoom: {
                    backgroundColor: 'rgba(47,69,84,0)',
                    dataBackgroundColor: 'rgba(255,255,255,0.3)',
                    fillerColor: 'rgba(167,183,204,0.4)',
                    handleColor: '#a7b7cc',
                    handleSize: '100%',
                    textStyle: {
                        color: '#ffffff'
                    }
                },
                markPoint: {
                    label: {
                        color: '#ffffff'
                    },
                    emphasis: {
                        label: {
                            color: '#ffffff'
                        }
                    }
                }
            });
            
            // vintage‰∏ªÈ¢ò
            echarts.registerTheme('vintage', {
                backgroundColor: '#fef8ef',
                textStyle: {
                    color: '#3c3c3c'
                },
                title: {
                    textStyle: {
                        color: '#516b83'
                    }
                },
                legend: {
                    textStyle: {
                        color: '#3c3c3c'
                    }
                },
                categoryAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#8b7355'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#8b7355'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#8b7355'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#d4c4a8'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.05)']
                        }
                    }
                },
                valueAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#8b7355'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#8b7355'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#8b7355'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#d4c4a8'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.05)']
                        }
                    }
                },
                series: [{
                    itemStyle: {
                        color: '#d87c7c'
                    }
                }]
            });
            
            // macarons‰∏ªÈ¢ò
            echarts.registerTheme('macarons', {
                backgroundColor: '#ffffff',
                textStyle: {
                    color: '#3c3c3c'
                },
                title: {
                    textStyle: {
                        color: '#516b83'
                    }
                },
                legend: {
                    textStyle: {
                        color: '#3c3c3c'
                    }
                },
                categoryAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#516b83'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#516b83'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#516b83'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#e6e6e6'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.2)', 'rgba(200,200,200,0.1)']
                        }
                    }
                },
                valueAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#516b83'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#516b83'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#516b83'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#e6e6e6'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.2)', 'rgba(200,200,200,0.1)']
                        }
                    }
                },
                series: [{
                    itemStyle: {
                        color: '#2ec7c9'
                    }
                }]
            });
            
            console.log('üé® ECharts‰∏ªÈ¢òÂ∑≤Ê≥®ÂÜå: dark, vintage, macarons');
            } else {
                console.warn('EChartsÊú™Âä†ËΩΩÔºåÂª∂ËøüÊ≥®ÂÜå‰∏ªÈ¢ò');
                setTimeout(registerEChartsThemes, 100);
            }
        }
        
        // Á´ãÂç≥Â∞ùËØïÊ≥®ÂÜå‰∏ªÈ¢ò
        registerEChartsThemes();
        
        // Á°Æ‰øùÂú®DOMÂä†ËΩΩÂÆåÊàêÂêéÂÜçÊ¨°Ê≥®ÂÜå‰∏ªÈ¢ò
        document.addEventListener('DOMContentLoaded', () => {
            registerEChartsThemes();
        });
    </script>
    
    <!-- Ê†∏ÂøÉÊ®°Âùó -->
    <script src="/static/js/core/ChartConfigSystem.js"></script>
    <script src="/static/js/core/ComponentRegistry.js"></script>
    <script src="/static/js/core/DragLayoutEngine.js"></script>
    <script src="/static/js/core/ApiExamples.js"></script>
    <script src="/static/js/core/ConfigManager.js"></script>
    <script src="/static/js/core/CanvasRenderer.js"></script>
    
    <!-- ‰∏ªÁºñËæëÂô® -->
    <script src="/static/js/DashboardEditor.js"></script>
    
    <script>
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÁöÑÂàùÂßãÂåñ
        console.log('üöÄ ÁºñËæëÂô®È°µÈù¢Âä†ËΩΩÂÆåÊàê');
        
        // Ê∑ªÂä†ÂÖ®Â±ÄÈîôËØØÂ§ÑÁêÜ
        window.addEventListener('error', (e) => {
            console.error('ÂÖ®Â±ÄÈîôËØØ:', e.error);
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            console.error('Êú™Â§ÑÁêÜÁöÑPromiseÊãíÁªù:', e.reason);
        });
        
        // È°µÈù¢ÂèØËßÅÊÄßÂèòÂåñÂ§ÑÁêÜ
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                console.log('È°µÈù¢ÈöêËóèÔºåÊöÇÂÅúËá™Âä®‰øùÂ≠ò');
                if (window.DashboardEditor) {
                    window.DashboardEditor.disableAutoSave();
                }
            } else {
                console.log('È°µÈù¢ÊòæÁ§∫ÔºåÊÅ¢Â§çËá™Âä®‰øùÂ≠ò');
                if (window.DashboardEditor) {
                    window.DashboardEditor.enableAutoSave();
                }
            }
        });
    </script>
</body>
</html>

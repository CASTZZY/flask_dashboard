<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯è§†åŒ–å¤§å±ç¼–è¾‘å™¨</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- ç»„ä»¶åº“é¢æ¿ -->
        <aside class="component-panel">
            <div class="component-panel-header">
                <h2>ğŸ“š ç»„ä»¶åº“</h2>
            </div>
            <div class="component-library" id="component-library">
                <!-- ç»„ä»¶å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
        </aside>
        
        <!-- ä¸»ç¼–è¾‘åŒºåŸŸ -->
        <main class="editor-main">
            <!-- å·¥å…·æ  -->
            <div class="toolbar" id="toolbar">
                <div class="toolbar-group">
                    <button class="toolbar-button primary" id="save-btn">
                        ğŸ’¾ ä¿å­˜
                    </button>
                    <button class="toolbar-button" id="preview-btn">
                        ğŸ‘ï¸ é¢„è§ˆ
                    </button>
                </div>
                
                <div class="toolbar-group">
                    <button class="toolbar-button" id="export-btn">
                        ğŸ“¤ å¯¼å‡º
                    </button>
                    <button class="toolbar-button danger" id="clear-btn">
                        ğŸ—‘ï¸ æ¸…é™¤
                    </button>
                </div>
                
                <!-- ä¸»é¢˜åˆ‡æ¢å™¨ -->
                <div class="toolbar-group theme-switcher">
                    <label for="theme-selector" class="theme-label">ğŸ¨ ä¸»é¢˜:</label>
                    <select id="theme-selector" class="theme-select">
                        <option value="default">é»˜è®¤ä¸»é¢˜</option>
                        <option value="dark">æ·±è‰²ä¸»é¢˜</option>
                        <option value="vintage">å¤å¤ä¸»é¢˜</option>
                        <option value="macarons">é©¬å¡é¾™ä¸»é¢˜</option>
                    </select>
                </div>
                
                <div class="toolbar-group" style="margin-left: auto;">
                    <a href="/" class="toolbar-button">
                        ğŸ“‹ ç®¡ç†é¡µé¢
                    </a>
                    <a href="/api-docs" class="toolbar-button">
                        ğŸ“š APIæ–‡æ¡£
                    </a>
                </div>
            </div>
            
            <!-- ç”»å¸ƒåŒºåŸŸ -->
            <div class="canvas-area">
                <div class="canvas" id="canvas">
                    <!-- ç»„ä»¶å°†æ‹–æ‹½åˆ°è¿™é‡Œ -->
                </div>
            </div>
            
            <!-- çŠ¶æ€æ  -->
            <div class="status-bar" id="status-bar">
                <div class="status-item">
                    <span>ç”»å¸ƒ:</span>
                    <span id="canvas-size">1920 Ã— 1080</span>
                </div>
                <div class="status-item">
                    <span id="component-count">ç»„ä»¶: 0</span>
                </div>
                <div class="status-item">
                    <span>çŠ¶æ€:</span>
                    <span id="save-status" class="status-clean">å·²ä¿å­˜</span>
                </div>
                <div class="status-item" style="margin-left: auto;">
                    <span>ğŸ¨ å¯è§†åŒ–å¤§å±ç¼–è¾‘å™¨</span>
                </div>
            </div>
        </main>
        
        <!-- é…ç½®é¢æ¿ -->
        <aside class="config-panel">
            <div class="config-panel-header">
                <h2>ğŸ›ï¸ é…ç½®é¢æ¿</h2>
            </div>
            <div class="config-panel-content" id="config-panel">
                <!-- é…ç½®å†…å®¹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
            </div>
        </aside>
    </div>

    <!-- å¼•å…¥ä¾èµ– -->
    <script src="/static/js/echarts.js"></script>
    <script src="/static/js/echarts-gl-master/dist/echarts-gl.min.js"></script>
    
    <!-- EChartsä¸»é¢˜ -->
    <script>
        // ç­‰å¾…EChartsåŠ è½½å®Œæˆåæ³¨å†Œä¸»é¢˜
        function registerEChartsThemes() {
            if (window.echarts) {
            // æ·±è‰²ä¸»é¢˜
            echarts.registerTheme('dark', {
                color: ['#4FC3F7', '#81C784', '#FFB74D', '#F06292', '#64B5F6'],
                backgroundColor: '#1e1e1e',
                textStyle: {
                    color: '#ffffff'
                },
                title: {
                    textStyle: {
                        color: '#ffffff'
                    },
                    subtextStyle: {
                        color: '#cccccc'
                    }
                },
                legend: {
                    textStyle: {
                        color: '#ffffff'
                    }
                },
                tooltip: {
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    textStyle: {
                        color: '#ffffff'
                    }
                },
                categoryAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#333333'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                valueAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#333333'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                line: {
                    itemStyle: {
                        borderWidth: 1
                    },
                    lineStyle: {
                        width: 2
                    },
                    symbolSize: 4,
                    symbol: 'emptyCircle',
                    smooth: false
                },
                bar: {
                    itemStyle: {
                        barBorderWidth: 0,
                        barBorderColor: '#ccc'
                    }
                },
                pie: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                scatter: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                boxplot: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                parallel: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                sankey: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                funnel: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                gauge: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    }
                },
                candlestick: {
                    itemStyle: {
                        color: '#4FC3F7',
                        color0: '#F06292',
                        borderColor: '#4FC3F7',
                        borderColor0: '#F06292',
                        borderWidth: 1
                    }
                },
                graph: {
                    itemStyle: {
                        borderWidth: 0,
                        borderColor: '#ccc'
                    },
                    lineStyle: {
                        width: 1,
                        color: '#666666'
                    },
                    symbolSize: 4,
                    symbol: 'emptyCircle',
                    smooth: false,
                    label: {
                        show: false
                    },
                    labelLayout: {
                        hideOverlap: false
                    },
                    emphasis: {
                        focus: 'series',
                        blurScope: 'coordinateSystem'
                    }
                },
                map: {
                    itemStyle: {
                        areaColor: '#eee',
                        borderColor: '#444',
                        borderWidth: 0.5
                    },
                    label: {
                        color: '#000'
                    },
                    emphasis: {
                        itemStyle: {
                            areaColor: 'rgba(255,215,0,0.8)',
                            borderColor: '#444',
                            borderWidth: 1
                        },
                        label: {
                            color: 'rgb(100,0,0)'
                        }
                    }
                },
                geo: {
                    itemStyle: {
                        areaColor: '#eee',
                        borderColor: '#444',
                        borderWidth: 0.5
                    },
                    label: {
                        color: '#000'
                    },
                    emphasis: {
                        itemStyle: {
                            areaColor: 'rgba(255,215,0,0.8)',
                            borderColor: '#444',
                            borderWidth: 1
                        },
                        label: {
                            color: 'rgb(100,0,0)'
                        }
                    }
                },
                categoryAxis: {
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        show: false,
                        lineStyle: {
                            color: ['#333333']
                        }
                    },
                    splitArea: {
                        show: false,
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                valueAxis: {
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#333333']
                        }
                    },
                    splitArea: {
                        show: false,
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                logAxis: {
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#333333']
                        }
                    },
                    splitArea: {
                        show: false,
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                timeAxis: {
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisTick: {
                        show: true,
                        lineStyle: {
                            color: '#666666'
                        }
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#ffffff'
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#333333']
                        }
                    },
                    splitArea: {
                        show: false,
                        areaStyle: {
                            color: ['rgba(250,250,250,0.05)', 'rgba(200,200,200,0.02)']
                        }
                    }
                },
                toolbox: {
                    iconStyle: {
                        borderColor: '#ffffff'
                    },
                    emphasis: {
                        iconStyle: {
                            borderColor: '#4FC3F7'
                        }
                    }
                },
                timeline: {
                    lineStyle: {
                        color: '#666666',
                        width: 1
                    },
                    itemStyle: {
                        color: '#666666',
                        borderWidth: 1
                    },
                    controlStyle: {
                        color: '#666666',
                        borderColor: '#666666',
                        borderWidth: 0.5
                    },
                    checkpointStyle: {
                        color: '#4FC3F7',
                        borderColor: '#ffffff'
                    },
                    label: {
                        color: '#ffffff'
                    },
                    emphasis: {
                        itemStyle: {
                            color: '#4FC3F7'
                        },
                        controlStyle: {
                            color: '#4FC3F7',
                            borderColor: '#4FC3F7',
                            borderWidth: 0.5
                        },
                        label: {
                            color: '#ffffff'
                        }
                    }
                },
                visualMap: {
                    color: ['#bf444c', '#d88273', '#f6efa6']
                },
                dataZoom: {
                    backgroundColor: 'rgba(47,69,84,0)',
                    dataBackgroundColor: 'rgba(255,255,255,0.3)',
                    fillerColor: 'rgba(167,183,204,0.4)',
                    handleColor: '#a7b7cc',
                    handleSize: '100%',
                    textStyle: {
                        color: '#ffffff'
                    }
                },
                markPoint: {
                    label: {
                        color: '#ffffff'
                    },
                    emphasis: {
                        label: {
                            color: '#ffffff'
                        }
                    }
                }
            });
            
            // vintageä¸»é¢˜
            echarts.registerTheme('vintage', {
                backgroundColor: '#fef8ef',
                textStyle: {
                    color: '#3c3c3c'
                },
                title: {
                    textStyle: {
                        color: '#516b83'
                    }
                },
                legend: {
                    textStyle: {
                        color: '#3c3c3c'
                    }
                },
                categoryAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#8b7355'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#8b7355'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#8b7355'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#d4c4a8'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.05)']
                        }
                    }
                },
                valueAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#8b7355'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#8b7355'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#8b7355'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#d4c4a8'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.05)']
                        }
                    }
                },
                series: [{
                    itemStyle: {
                        color: '#d87c7c'
                    }
                }]
            });
            
            // macaronsä¸»é¢˜
            echarts.registerTheme('macarons', {
                backgroundColor: '#ffffff',
                textStyle: {
                    color: '#3c3c3c'
                },
                title: {
                    textStyle: {
                        color: '#516b83'
                    }
                },
                legend: {
                    textStyle: {
                        color: '#3c3c3c'
                    }
                },
                categoryAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#516b83'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#516b83'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#516b83'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#e6e6e6'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.2)', 'rgba(200,200,200,0.1)']
                        }
                    }
                },
                valueAxis: {
                    axisLine: {
                        lineStyle: {
                            color: '#516b83'
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: '#516b83'
                        }
                    },
                    axisLabel: {
                        textStyle: {
                            color: '#516b83'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#e6e6e6'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(250,250,250,0.2)', 'rgba(200,200,200,0.1)']
                        }
                    }
                },
                series: [{
                    itemStyle: {
                        color: '#2ec7c9'
                    }
                }]
            });
            
            console.log('ğŸ¨ EChartsä¸»é¢˜å·²æ³¨å†Œ: dark, vintage, macarons');
            } else {
                console.warn('EChartsæœªåŠ è½½ï¼Œå»¶è¿Ÿæ³¨å†Œä¸»é¢˜');
                setTimeout(registerEChartsThemes, 100);
            }
        }
        
        // ç«‹å³å°è¯•æ³¨å†Œä¸»é¢˜
        registerEChartsThemes();
        
        // ç¡®ä¿åœ¨DOMåŠ è½½å®Œæˆåå†æ¬¡æ³¨å†Œä¸»é¢˜
        document.addEventListener('DOMContentLoaded', () => {
            registerEChartsThemes();
        });
    </script>
    
    <!-- æ ¸å¿ƒæ¨¡å— -->
    <script src="/static/js/core/ChartConfigSystem.js"></script>
    <script src="/static/js/core/ComponentRegistry.js"></script>
    <script src="/static/js/core/DragLayoutEngine.js"></script>
    <script src="/static/js/core/ApiExamples.js"></script>
    <script src="/static/js/core/ConfigManager.js"></script>
    <script src="/static/js/core/CanvasRenderer.js"></script>
    
    <!-- ä¸»ç¼–è¾‘å™¨ -->
    <script src="/static/js/DashboardEditor.js"></script>
    
    <script>
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        console.log('ğŸš€ ç¼–è¾‘å™¨é¡µé¢åŠ è½½å®Œæˆ');
        
        // æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†
        window.addEventListener('error', (e) => {
            console.error('å…¨å±€é”™è¯¯:', e.error);
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            console.error('æœªå¤„ç†çš„Promiseæ‹’ç»:', e.reason);
        });
        
        // é¡µé¢å¯è§æ€§å˜åŒ–å¤„ç†
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                console.log('é¡µé¢éšè—ï¼Œæš‚åœè‡ªåŠ¨ä¿å­˜');
                if (window.DashboardEditor) {
                    window.DashboardEditor.disableAutoSave();
                }
            } else {
                console.log('é¡µé¢æ˜¾ç¤ºï¼Œæ¢å¤è‡ªåŠ¨ä¿å­˜');
                if (window.DashboardEditor) {
                    window.DashboardEditor.enableAutoSave();
                }
            }
        });
    </script>
</body>
</html>
